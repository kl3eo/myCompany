{"ast":null,"code":"import _objectSpread from \"/home/alex/react_projects/myCompany/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/alex/react_projects/myCompany/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/alex/react_projects/myCompany/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/alex/react_projects/myCompany/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/alex/react_projects/myCompany/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/alex/react_projects/myCompany/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/alex/react_projects/myCompany/src/components/employees/details/employeeDetailsUpdateComponent.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { employeeDetailsAction, employeeUpdateAction } from '../../../actions/employeesActions';\nimport HeaderComponent from '../../commons/headerComponent';\nimport EmployeeDetailsUpdateView from './employeeDetailsUpdateView'; //import { getCookie } from '../../../utils/cookies';\n\nvar user = null;\n\nvar EmployeeDetailsUpdateComponent = /*#__PURE__*/function (_Component) {\n  _inherits(EmployeeDetailsUpdateComponent, _Component);\n\n  function EmployeeDetailsUpdateComponent(props) {\n    var _this;\n\n    _classCallCheck(this, EmployeeDetailsUpdateComponent);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(EmployeeDetailsUpdateComponent).call(this, props));\n    _this.state = {\n      isSuccess: null,\n      message: '',\n      employee: {},\n      profileImg: '',\n      oldProfileImg: ''\n    };\n\n    _this.onFileChange = function (event) {\n      _this.setState({\n        profileImg: event.target.files[0]\n      });\n\n      _this.setState({\n        oldProfileImg: ''\n      });\n    };\n\n    _this.onHandleUpdateEmployee = function (event) {\n      event.preventDefault();\n      var name = event.target.name.value;\n      var position = event.target.position.value;\n      var username = event.target.username.value;\n      var password = event.target.password.value;\n      var email = event.target.email.value;\n      var role = event.target.role.value;\n\n      var _id = _this.props.response.details.response._id ? _this.props.response.details.response._id : _this.props.response.fill.response._id;\n\n      var profileImg = _this.state.profileImg;\n\n      if (_this.state.oldProfileImg === '') {\n        var data = {\n          name: name,\n          position: position,\n          username: username,\n          password: password,\n          role: role,\n          _id: _id,\n          email: email,\n          profileImg: profileImg,\n          admin: {\n            access: user.role,\n            id: user.id\n          }\n        };\n\n        _this.props.dispatch(employeeUpdateAction(data));\n      } else {\n        var _data = {\n          name: name,\n          position: position,\n          username: username,\n          password: password,\n          role: role,\n          _id: _id,\n          email: email,\n          admin: {\n            access: user.role,\n            id: user.id\n          }\n        };\n\n        _this.props.dispatch(employeeUpdateAction(_data));\n      }\n    };\n\n    user = JSON.parse(localStorage.getItem('user'));\n    return _this;\n  }\n\n  _createClass(EmployeeDetailsUpdateComponent, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.props.dispatch(employeeDetailsAction({\n        employeeID: this.props.match.params.id\n      }));\n\n      if (typeof this.props.response.fill.response !== 'undefined') {\n        this.setState(_objectSpread({}, this.state, {\n          oldProfileImg: this.props.response.fill.response.profileImg\n        }), function () {//console.log('set1 to '+ this.state.oldProfileImg)\n        });\n      } else {\n        if (typeof this.props.response.details.response !== 'undefined') {\n          this.setState(_objectSpread({}, this.state, {\n            oldProfileImg: this.props.response.details.response.profileImg\n          }), function () {//console.log('set2 to '+ this.state.oldProfileImg)\n          });\n        }\n\n        ;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (typeof this.props.response.details.response === 'undefined') {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 111\n          },\n          __self: this\n        }, \"Loading...\");\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, React.createElement(HeaderComponent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }), React.createElement(EmployeeDetailsUpdateView, {\n        message: this.state.message,\n        success: this.state.isSuccess,\n        handleUpdateEmployee: this.onHandleUpdateEmployee,\n        employee: this.props.response.details.response,\n        role: user.role,\n        onFileChange: this.onFileChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      //console.log(nextProps.response)\n      if (nextProps.response.update.hasOwnProperty('response')) {\n        if (nextProps.response.update.response.success !== prevState.isSuccess) {\n          return {\n            isSuccess: nextProps.response.update.response.success,\n            message: nextProps.response.update.response.message,\n            employee: nextProps.response.details.response\n          };\n        } else {\n          return {\n            isSuccess: nextProps.response.update.response.success,\n            message: nextProps.response.update.response.message\n          };\n        }\n      } else {\n        return null;\n      }\n    }\n  }]);\n\n  return EmployeeDetailsUpdateComponent;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    response: state\n  };\n};\n\nexport default connect(mapStateToProps)(EmployeeDetailsUpdateComponent);","map":{"version":3,"sources":["/home/alex/react_projects/myCompany/src/components/employees/details/employeeDetailsUpdateComponent.js"],"names":["React","Component","connect","employeeDetailsAction","employeeUpdateAction","HeaderComponent","EmployeeDetailsUpdateView","user","EmployeeDetailsUpdateComponent","props","state","isSuccess","message","employee","profileImg","oldProfileImg","onFileChange","event","setState","target","files","onHandleUpdateEmployee","preventDefault","name","value","position","username","password","email","role","_id","response","details","fill","data","admin","access","id","dispatch","JSON","parse","localStorage","getItem","employeeID","match","params","nextProps","prevState","update","hasOwnProperty","success","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\n\nimport { employeeDetailsAction, employeeUpdateAction } from '../../../actions/employeesActions';\n\nimport HeaderComponent from '../../commons/headerComponent';\nimport EmployeeDetailsUpdateView from './employeeDetailsUpdateView';\n\n//import { getCookie } from '../../../utils/cookies';\n\nvar user = null;\n\nclass EmployeeDetailsUpdateComponent extends Component {\n\n  state = {\n    isSuccess: null,\n    message: '',\n    employee: {},\n    profileImg: '',\n    oldProfileImg: ''\n  }\n  \n  constructor(props) {\n    super(props);\n    user = JSON.parse(localStorage.getItem('user'));\n  }\n  \n  componentDidMount() {\n    this.props.dispatch(employeeDetailsAction({ employeeID: this.props.match.params.id }));\n\n    if (typeof this.props.response.fill.response !== 'undefined') {\n        this.setState({...this.state, oldProfileImg: this.props.response.fill.response.profileImg}, () => {\n\t//console.log('set1 to '+ this.state.oldProfileImg)\n\t});\n    } else {\n\n        if (typeof this.props.response.details.response !== 'undefined') {\n            this.setState({...this.state, oldProfileImg: this.props.response.details.response.profileImg}, () => {\n\t    //console.log('set2 to '+ this.state.oldProfileImg)\n\t    });\n        };\n    }\n  }\n\n  onFileChange = (event)  => {\n        this.setState({ profileImg: event.target.files[0] })\n\tthis.setState({ oldProfileImg: '' })\n  }\n      \n  onHandleUpdateEmployee = (event) => {\n    event.preventDefault();\n\n    let name = event.target.name.value;\n    let position = event.target.position.value;\n    let username = event.target.username.value;\n    let password = event.target.password.value;\n    let email = event.target.email.value;\n    let role = event.target.role.value;\n    let _id = this.props.response.details.response._id ? this.props.response.details.response._id : this.props.response.fill.response._id;\n    let profileImg = this.state.profileImg;\n\nif (this.state.oldProfileImg === '') {\n    const data = {\n      name, position, username, password, role, _id, email, profileImg, \n      admin: {\n        access: user.role,\n        id: user.id\n      }\n    };\n    this.props.dispatch(employeeUpdateAction(data));\n} else {\n    const data = {\n      name, position, username, password, role, _id, email, \n      admin: {\n        access: user.role,\n        id: user.id\n      }\n    };\n    this.props.dispatch(employeeUpdateAction(data));\n}\n    \n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n//console.log(nextProps.response)\n    if (nextProps.response.update.hasOwnProperty('response')) {\n     \n      if (nextProps.response.update.response.success !== prevState.isSuccess) {\n\n\treturn {\n          \tisSuccess: nextProps.response.update.response.success,\n          \tmessage: nextProps.response.update.response.message,\n          \temployee: nextProps.response.details.response\n        };\n\n      } else {\n      \n\treturn {\n          \tisSuccess: nextProps.response.update.response.success,\n          \tmessage: nextProps.response.update.response.message\n        };\n      }\n    } else {\n\n\treturn null;\n    }\n  }\n\n  render() {\n    if (typeof this.props.response.details.response === 'undefined') {\n      return <div>Loading...</div>\n    }\n    \n    return (\n      <div>\n        <HeaderComponent />\n        <EmployeeDetailsUpdateView\n          message={this.state.message}\n          success={this.state.isSuccess}\n          handleUpdateEmployee={this.onHandleUpdateEmployee}\n          employee={this.props.response.details.response} \n\t  role={user.role} \n\t  onFileChange={this.onFileChange}\n         />\n       </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  response: state\n});\n\nexport default connect(mapStateToProps)(EmployeeDetailsUpdateComponent);\n"]},"metadata":{},"sourceType":"module"}